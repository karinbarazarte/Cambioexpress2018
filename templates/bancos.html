
{% extends 'dashboard.html' %}
{% block content %}
<div class="form-container">
    <h2>Gesti√≥n de Bancos - {{ pais|capitalize }}</h2>
    <form id="formBanco">
        <input type="text" id="nombreBanco" placeholder="Nombre del banco" required>
        <button type="submit">Agregar</button>
    </form>
    <br>
    <table>
        <thead>
            <tr>
                <th>Banco</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody id="tablaBancos"></tbody>
    </table>
</div>

<script>
const pais = "{{ pais }}";

// Cargar lista de bancos
async function cargarBancos() {
    const res = await fetch(`/api/bancos/${pais}`);
    const data = await res.json();
    const tbody = document.getElementById('tablaBancos');
    tbody.innerHTML = "";
    data.forEach((banco, i) => {
        tbody.innerHTML += `
            <tr>
                <td>${banco}</td>
                <td>
                    <button onclick="editarBanco(${i}, '${banco}')">Editar</button>
                    <button onclick="eliminarBanco(${i})">Eliminar</button>
                </td>
            </tr>
        `;
    });
}

// Agregar banco
document.getElementById('formBanco').addEventListener('submit', async (e) => {
    e.preventDefault();
    const nombre = document.getElementById('nombreBanco').value;
    await fetch(`/api/bancos/${pais}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ nombre })
    });
    document.getElementById('nombreBanco').value = '';
    cargarBancos();
});

// Eliminar banco
async function eliminarBanco(index) {
    await fetch(`/api/bancos/${pais}/${index}`, { method: 'DELETE' });
    cargarBancos();
}

// Editar banco (prompt simple)
async function editarBanco(index, actual) {
    const nuevo = prompt("Nuevo nombre del banco:", actual);
    if (nuevo) {
        await fetch(`/api/bancos/${pais}/${index}`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ nombre: nuevo })
        });
        cargarBancos();
    }
}

// Cargar al inicio
cargarBancos();
</script>
{% endblock %}

